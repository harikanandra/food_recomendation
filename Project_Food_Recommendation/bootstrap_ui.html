<!DOCTYPE html>
<html>
<head>
    <title>Smart Recipe System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">
    <div class="card p-4">

        <h3 class="text-center text-primary">
            Smart Recipe Recommendation System
        </h3>

        <div class="mb-3">
            <label>Health Goal</label>
            <select id="goal" class="form-control">
                <option value="weight_loss">Weight Loss</option>
                <option value="muscle_gain">Muscle Gain</option>
                <option value="normal">Normal Health</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Available Ingredients</label>
            <input type="text" id="ingredients" class="form-control"
                   placeholder="rice, onion, tomato">
        </div>

        <div class="mb-3">
            <label>Max Cooking Time (minutes)</label>
            <input type="number" id="time" class="form-control" placeholder="30">
        </div>

        <button class="btn btn-primary" onclick="getRecipes()">Get Recipes</button>

        <div id="output" class="mt-4"></div>

    </div>
</div>

<script>
async function getRecipes() {

    let ingredientsText = document.getElementById("ingredients").value;
    let goal = document.getElementById("goal").value;
    let time = document.getElementById("time").value;

    let ingredientsList = ingredientsText.split(",");

    let response = await fetch("http://127.0.0.1:8000/recommend", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            ingredients: ingredientsList,
            goal: goal,
            max_time: time,
            top_k: 5
        })
    });

    let data = await response.json();

    let outputDiv = document.getElementById("output");
    outputDiv.innerHTML = "<h5 class='text-success'>Recommended Recipes:</h5>";

    data.recommendations.forEach((rec, index) => {
        outputDiv.innerHTML += `
        <div class="card p-3 mb-2">
            <b>${index + 1}. ${rec.dish}</b><br>
            Cuisine: ${rec.cuisine}<br>
            Diet: ${rec.diet}<br>
            Prep Time: ${rec.prep_time}<br>
            Calories: ${rec.calories}<br>
            Fat: ${rec.fat}<br>
            <b>Suggested Substitute:</b> ${rec.suggested_substitute}<br>

            <button onclick="sendFeedback('${rec.dish}', 'like')">üëç</button>
            <button onclick="sendFeedback('${rec.dish}', 'dislike')">üëé</button>
        </div>
        `;
    });
}

function sendFeedback(dish, type){
    alert("Feedback saved: " + dish + " -> " + type);
}
</script>

</body>
</html>
